<div class="profile-container">
    <mat-card class="profile-card">
        <div class="profile-header">
            <div class="avatar-large">
                <mat-icon>account_circle</mat-icon>
            </div>
            <div class="header-info">
                <h1>{{ user?.name || 'User Name' }}</h1>
                <p class="role-badge">{{ user?.role || 'Admin' }}</p>
            </div>
            <button mat-stroked-button color="primary" (click)="openEditProfile()">Edit Profile</button>
        </div>

        <mat-divider></mat-divider>

        <div class="profile-details">
            <div class="detail-item">
                <span class="label">Email</span>
                <span class="value">{{ user?.email }}</span>
            </div>
            <div class="detail-item">
                <span class="label">Phone</span>
                <span class="value">+92 300 1234567 (Mock)</span>
            </div>
            <div class="detail-item">
                <span class="label">Department</span>
                <span class="value">Disaster Management Unit</span>
            </div>
            <div class="detail-item">
                <span class="label">Location</span>
                <span class="value">Islamabad, Pakistan</span>
            </div>
        </div>

        <!-- Victim Specific Section -->
        <ng-container *ngIf="user?.role === 'victim' && (victimProfile$ | async) as vp">
            <mat-divider></mat-divider>
            <div class="victim-card-section">
                <div class="qr-container">
                    <div class="qr-placeholder">
                        <mat-icon>qr_code_2</mat-icon>
                        <span>{{ vp.id || 'N/A' }}</span>
                    </div>
                    <p class="qr-hint">Scan for Aid Verification</p>
                </div>

                <div class="family-stats">
                    <div class="stat-box">
                        <span class="val">{{ vp.familySize || 1 }}</span>
                        <span class="lbl">Family Members</span>
                    </div>
                    <div class="stat-box">
                        <span class="val text-warn">{{ vp.specialNeeds?.length || 0 }}</span>
                        <span class="lbl">Special Needs</span>
                    </div>
                </div>

                <div class="special-needs-list" *ngIf="vp.specialNeeds && vp.specialNeeds.length > 0">
                    <span class="lbl">Registered Needs:</span>
                    <div class="chips">
                        <span *ngFor="let need of vp.specialNeeds" class="chip">{{ need }}</span>
                    </div>
                </div>
            </div>
        </ng-container>

        <!-- Volunteer Specific Section -->
        <ng-container *ngIf="user?.role === 'volunteer'">
            <mat-divider></mat-divider>
            <div class="victim-card-section">
                <div class="family-stats">
                    <div class="stat-box">
                        <span class="val">On Duty</span>
                        <span class="lbl">Current Status</span>
                    </div>
                    <div class="stat-box">
                        <span class="val">Level 3</span>
                        <span class="lbl">Clearance</span>
                    </div>
                </div>

                <div class="special-needs-list">
                    <span class="lbl">Expertise Areas:</span>
                    <div class="chips">
                        <span class="chip">First Aid</span>
                        <span class="chip">Logistics</span>
                        <span class="chip">Crowd Control</span>
                    </div>
                </div>
            </div>
        </ng-container>
    </mat-card>

    <mat-card class="activity-card">
        <mat-card-header>
            <mat-card-title>Recent Activity</mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <div class="activity-list">
                <div *ngFor="let act of activities" class="activity-item">
                    <mat-icon>history</mat-icon>
                    <div class="act-info">
                        <span class="act-details">{{ act.action }}</span>
                        <span class="act-time">{{ act.time | date:'medium' }}</span>
                    </div>
                </div>
            </div>
        </mat-card-content>
    </mat-card>
</div>